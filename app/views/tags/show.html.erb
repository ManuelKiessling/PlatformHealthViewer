<h1>Manage Tags</h1>

<div id="tags">
  <%= render :partial => @tags, :locals => { :list => true } %>
</div>

<div id="formarea">

  <div id="form">
    <%= form_for Tag.new, :remote => true do |f| %>
      <strong>
        <%= f.label :name, "Tag name: " %><br />
      </strong>
      <%= f.text_field :name %><br />
      <br />
      <%= f.label :tags, "Tags: " %><br />
      <%= f.text_field :tags %><br />
      <%= f.label :event_sources, "Event sources: " %><br />
      <%= f.text_field :event_sources %><br />
      <%= f.label :event_names, "Event names: " %><br />
      <%= f.text_field :event_names %><br />
      <%= f.submit "Add tag" %>
    <% end %>
  </div>

  <script type="text/javascript">
    $("#form").droppable({
      activeClass: "droppable-state-active",
      hoverClass: "droppable-state-hover",
      drop: function( event, ui ) {
        $(this).addClass( "droppable-state-dropped" );

        if (ui.draggable.hasClass("subtag")) {
          document.getElementById("tag_tags").value = ui.draggable.text() + ", " + document.getElementById("tag_tags").value;
        } else if (ui.draggable.hasClass("source")) {
          document.getElementById("tag_event_sources").value = ui.draggable.text() + ", " + document.getElementById("tag_event_sources").value;
        } else if (ui.draggable.hasClass("name")) {
          document.getElementById("tag_event_names").value = ui.draggable.text() + ", " + document.getElementById("tag_event_names").value;
        }

        ui.helper.hide();

        $("#notice").html(ui.draggable.text());
        $("#notice").fadeIn(400, function() {
          $("#notice").fadeOut(400);
        });
      }
    });
  </script>

  <div id="notice"><%=h flash[:notice] %></div>

</div>
